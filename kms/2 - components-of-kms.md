# Components of KMS

1. Customer Master Keys (CMK)
2. Data Encryption Keys (DEK)
3. Key Policies
4. Grants

## Customer Master Keys (CMK)
* Main key type in KMS
* Encrypts data up to 4KB
* Typically used in relation to DEKs
* Can generate, encrypt, and decrypt DEKs

There are two types of CMKs
* **AWS managed CMKs**
	* Used by other AWS services to encrypt data
	* Can only be used by services in the same region, because KMS is region-specific
* **Customer managed CMKs**
	* Can rotate, govern access and key policy all by yourself
	* Can enable/disable keys as needed
	* Can also be used by other AWS services

## Data Encryption Keys (DEK)
* Generated by a CMK
* Can encrypt data of any size
* When data is encrypted, the DEK is also encrypted and stored alongside the encrypted data
	* So the payload is encrypted data + encrypted DEK
* The plain text DEK, that was generated by a CMK, is only stored in memory. So once encryption is done, the plain text DEK is lost
* The encrypted DEK can be decrypted to its plaintext key by using the CMK that generated the DEK

## Key Policies
* Define who can use and access certain CMKs
* Key policies are *resource-based policies* because they are tied to CMKs
* Different policies can be created for different CMKs
* Permissions for a policy are defined in a JSON key policy file

## Grants
* Another way to control access and use of CMKs
* Can delegate a subset of your own access/permissions to a CMK for principals
* Less risk of someone changing access control permissions for the associated CMK
* Eliminates possibily of **anyone** using the permission `kms:PutKeyPolicy`
